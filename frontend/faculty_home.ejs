<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Faculty Home</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(45deg, #FFD700, #FFA500, #FF8C00);
            background-size: 400% 400%;
            animation: gradient 5s ease infinite;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        @keyframes gradient {
            0% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
            100% {
                background-position: 0% 50%;
            }
        }

        header {
            background-color: #333;
            color: #fff;
            padding: 20px;
            text-align: center;
            width: 100%;
        }

        .sections-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 80%;
            margin-top: 20px;
        }

        .section {
            background-color: #add8e6; /* Light blue background */
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            padding: 20px;
            width: 100%;
        }

        .quiz-container {
            border-top: 1px solid #ccc; /* Separator line */
            padding-top: 20px; /* Space between quizzes */
        }

    </style>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.2/jquery.min.js"></script>
    <script type="text/javascript">
        $(document).ready( function () {
            $('#myform').submit( function () {
                var formdata = $(this).serialize();
                $.ajax({
                    type: "POST",
                    url: "/add_group",
                    data: formdata
                 });
                return false;
            });
        });
    </script>
</head>

<body>
    <header>
        <h1>Welcome, <%= name %>
        </h1>
        <p>Email: <%= email %>
        </p>
    </header>

    <div class="sections-container">
        <!-- Add Group Section -->
        <div class="section">
            <h2>Add New Group</h2>
            <form action="/faculty_view_group" method="post"> <!-- Wrap the select inside a form -->
                <input type="text" style="display: none;" name="email" value=<%= email %>>
                <select name="selectedGroup" class="group-list">
                    <% gc.forEach(function(group) { %>
                        <option value="<%= group.groupCode %>">
                            <%= group.name %>
                        </option>
                        <% }); %>

                </select>
                <button type="submit">Go To Group</button>
            </form>
            <form id = "myform" action="/add_group" method="post">
                <input type="text" name="groupName" placeholder="Enter Group Name">
                <input type="text" style="display: none;" name="email" value=<%= email %>>

                <input type="text" id="gc" name="groupCode" readonly>
                <button type="button" onclick=generateUniqueGroupId()>Regenerate</button>

                <button type="submit">Add Group</button>
            </form>
            
        </div>

        <!-- Quizzes Section -->
        <div class="section">
            <h2>Quizzes</h2>
            <% quizzes.forEach(function(quiz) { %>
                <div class="quiz-container">
                    <h3>
                        <%= quiz.title %>
                    </h3>
                    <p>Start Date: <%= quiz.startDate %>
                    </p>
                    <p>End Date: <%= quiz.endDate %>
                    </p>
                    <p>Time of Quiz: <%= quiz.startTime %> - <%= quiz.time %>
                    </p>
                </div>
                <% if (quizzes.indexOf(quiz) !== quizzes.length - 1) { %>
                    <hr /> <!-- Add separator unless it's the last quiz -->
                <% } %>
            <% }); %>
        </div>
    </div>

    <script>
        var allGroups = <%- JSON.stringify(allGroups) %>;
        console.log("group data:", allGroups);

        // function submitForm() {
        //     const form = document.getElementById('myForm');
        //     console.log(form)
        //     const formData = new FormData(form);

        //     const obj = {};

        //     for(let ob of formData){
        //         obj[ob[0]] = ob[1];
        //     }

        //     console.log(obj)

        //     fetch('/add_group', {
        //         method: 'POST',
        //         body: obj
        //     })
        //     .then(response => response.json())
        //     .then(data => {
        //         console.log('Success:', data);
        //         // Handle success response
        //     })
        //     .catch((error) => {
        //         console.error('Error:', error);
        //         // Handle error
        //     });
        // }


        function generateUniqueId() {
            const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
            const idLength = 8;
            let id = '';

            for (let i = 0; i < idLength; i++) {
                const randomIndex = Math.floor(Math.random() * characters.length);
                id += characters[randomIndex];
            }

            return id;
        }


        function generateUniqueGroupId() {
            let uniqueId;

            do {
                uniqueId = generateUniqueId();

            } while (allGroups.includes(uniqueId));

            document.getElementById("gc").value = uniqueId;

            console.log(uniqueId)
        }
    </script>

</body>
</html>
